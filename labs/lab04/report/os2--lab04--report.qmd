---
# Preamble

## Author
author:
  name: Гелдиев Ыхлас
  degrees: DSc
  orcid: 0000-0002-0877-7063
  email: 1032249184@pfur.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6
## Title
title: "Лабораторная работа №4"
subtitle: "Работа с программными пакетами"
license: "CC BY"
## Generic options
lang: ru-RU
number-sections: true
toc: true
toc-title: "Содержание"
toc-depth: 2
## Crossref customization
crossref:
  lof-title: "Список иллюстраций"
  lot-title: "Список таблиц"
  lol-title: "Листинги"
## Bibliography
bibliography:
  - bib/cite.bib
csl: _resources/csl/gost-r-7-0-5-2008-numeric.csl
## Formats
format:
  ### Pdf output format
  pdf:
    toc: true
    number-sections: true
    colorlinks: false
    toc-depth: 2
    lof: true # List of figures
    lot: true # List of tables
    #### Document
    documentclass: scrreprt
    papersize: a4
    fontsize: 12pt
    linestretch: 1.5
    #### Language
    babel-lang: russian
    babel-otherlangs: english
    #### Biblatex
    cite-method: biblatex
    biblio-style: gost-numeric
    biblatexoptions:
      - backend=biber
      - langhook=extras
      - autolang=other*
    #### Misc options
    csquotes: true
    indent: true
    header-includes: |
      \usepackage{indentfirst}
      \usepackage{float}
      \floatplacement{figure}{H}
      \usepackage[math,RM={Scale=0.94},SS={Scale=0.94},SScon={Scale=0.94},TT={Scale=MatchLowercase,FakeStretch=0.9},DefaultFeatures={Ligatures=Common}]{plex-otf}
  ### Docx output format
  docx:
    toc: true
    number-sections: true
    toc-depth: 2
---

# Цель работы

Получить навыки работы с репозиториями и менеджерами пакетов

# Задание

1. Изучите, как и в каких файлах подключаются репозитории для установки программного обеспечения; изучите основные возможности (поиск, установка, обновление, удаление пакета, работа с историей действий) команды dnf (см. раздел 4.4.1).
2. Изучите и повторите процесс установки/удаления определённого пакета с использованием возможностей dnf (см. раздел 4.4.1).
3. Изучите и повторите процесс установки/удаления определённого пакета с использованием возможностей rpm (см. раздел 4.4.2).

# Выполнение лабораторной работы

## Работа с репозиториями

1. В консоли перейдите в режим работы суперпользователя (используйте команду `su -`) ([рис. @fig-001])

2. Перейдите в каталог /etc/yum.repos.d и изучите содержание каталога и файлов репозиториев: ([рис. @fig-001])
   `cd /etc/yum.repos.d`
   `ls`
   `cat название_репозитория.repo`

   ![Переход](image/root_start.png){#fig-001}

3. Выведите на экран список репозиториев: ([рис. @fig-002])
   `dnf repolist`
   и поясните полученную информацию.

4. Выведите на экран список пакетов, в названии или описании которых есть слово user: ([рис. @fig-002])
   `dnf search user`
   и поясните полученную информацию.

![Операции с dnf](image/dnf_repolist_search.png){#fig-002}

5. Установите nmap, предварительно изучив информацию по имеющимся пакетам:
   `dnf search nmap`
   `dnf info nmap`
   `dnf install nmap`
   `dnf install nmap\*`

   ![Установка nmap 1](image/installing_nmap_1.png)

   ![Установка nmap 2](image/installing_nmap_2.png)

   Поясните разницу между dnf install nmap и dnf install nmap\*.

   - `dnf install nmap` устанавливает только пакет **nmap**, а `dnf install nmap\*` подбирает и ставит **все** доступные пакеты, имена которых начинаются с **nmap**.

6. Удалите nmap:
   `dnf remove nmap`
   `dnf remove nmap\*`

   ![Удаляем nmap](image/removing_nmap.png)

7. Получите список имеющихся групп пакетов, затем установите группу пакетов RPM Development Tools:
   `dnf groups list`
   `LANG=C dnf groups list`
   `dnf groups info "RPM Development Tools"`
   `dnf groupinstall "RPM Development Tools"`
   Для удаления группы пакетов RPM Development Tools можно воспользоваться командой
   `dnf groupremove "RPM Development Tools"`

   ![dnf группы 1](image/dnf_groups_1.png)

   ![dnf группы 2](image/dnf_groups_2.png)

   ![`dnf groupremove`](image/dnf_groupremove.png)

8. Посмотрите историю использования команды dnf:
   `dnf history`
   и отмените последнее, например шестое по счёту, действие:
   `dnf history undo 6`

   ![`dnf history`](image/dnf_history.png)

   ![`dnf history undo 6`](image/dnf_history_undo.png)

## Использование rpm

Предположим, что требуется установить текстовый браузер lynx из rpm-пакета.

1. Скачайте rpm-пакет lynx: ([рис. @fig-003])
   `dnf list lynx`
   `dnf install lynx --downloadonly`
2. Найдите каталог, в который был помещён пакет после загрузки: ([рис. @fig-003])
   `find /var/cache/dnf/ -name lynx\*`
3. Перейдите в этот каталог и затем установите rpm-пакет: ([рис. @fig-003])
   `rpm -Uhv lynx-<версия>.rpm`
4. Определите расположение исполняемого файла: ([рис. @fig-003])
   `which lynx`

   ![Устанавливаем lynx](image/lynx_install.png){#fig-003}

5. Используя rpm, определите по имени файла, к какому пакету принадлежит lynx:
   `rpm -qf $(which lynx)`
   и получите дополнительную информацию о содержимом пакета, введя:
   `rpm -qi lynx`

   ![`rpm -qf -qi`](image/rpm-qf.png)

6. Получите список всех файлов в пакете, используя:
   `rpm -ql lynx`
   а также выведите перечень файлов с документацией пакета, введя:
   `rpm -qd lynx`
   Посмотрите файлы документации, применив команду `man lynx`.

   ![rpm -ql](image/rpm-ql.png)

   ![rpm -qd](image/rpm-qd.png)

   ![man lynx](image/man_lynx.png)

7. Выведите на экран перечень и месторасположение конфигурационных файлов пакета: ([рис. @fig-004])
   `rpm -qc lynx`

8. Выведите на экран расположение и содержание скриптов, выполняемых при установке пакета: ([рис. @fig-004])
   `rpm -q --scripts lynx`

   ![rpm -qc --scripts](image/rpm-qc--scripts.png){#fig-004}

9. В отдельном терминале под своей учётной записью запустите текстовый браузер lynx, чтобы проверить корректность установки пакета.

![lynx](image/lynx.png)

10. Вернитесь в терминал с учётной записью root и удалите пакет:
    `rpm -e lynx`
    `ls`

    ![rpm -e lynx](image/remove_lynx.png)

Предположим, что требуется из rpm-пакетов установить dnsmasq (DNS-, DHCP- и TFTPсервер).

1. Установите пакет dnsmasq: ([рис. @fig-005])
   `dnf list dnsmasq`
   `dnf install dnsmasq`
   и определите расположение исполняемого файла: ([рис. @fig-005])
   `which dnsmasq`
2. Определите по имени файла, к какому пакету принадлежит dnsmasq: ([рис. @fig-005])
   `rpm -qf $(which dnsmasq)`
   и получите дополнительную информацию о содержимом пакета: ([рис. @fig-005])
   `rpm -qi dnsmasq`

   ![dnsmasq 1](image/dnsmasq.png){#fig-005}

3. Получите список всех файлов в пакете:
   `rpm -ql dnsmasq`

   ![rpm -ql dnsmasq](image/dnsmasq_2.png)

   а также выведите перечень файлов с документацией пакета:
   `rpm -qd dnsmasq`

   ![rpm -qd dnsmasq](image/dnsmasq_3.png)

   Посмотрите файлы документации, применив команду `man dnsmasq`.

   ![`man dnsmasq`](image/man_dnsmasq.png)

4. Выведите на экран перечень и месторасположение конфигурационных файлов пакета: ([рис. @fig-006])
   `rpm -qc dnsmasq`

5. Выведите на экран расположение и содержание скриптов, выполняемых при установке пакета: ([рис. @fig-006])
   `rpm -q --scripts dnsmasq`
   и поясните, для чего предназначены скрипты.

   ![dnsmasq 4](image/dnsmasq_4.png){#fig-006}

6. Вернитесь в терминал с учётной записью root и удалите пакет:
   `rpm -e dnsmasq`

   ![rpm -e dnsmasq](image/dnsmasq_remove.png)

# Контрольные вопросы

1. Какая команда позволяет вам искать пакет rpm, содержащий файл useradd?

- rpm -qf /usr/sbin/useradd или dnf provides \*/useradd

2. Какие команды вам нужно использовать, чтобы показать имя группы dnf, которая содержит инструменты безопасности и показывает, что находится в этой группе?

- dnf groupinfo "Security Tools" (или dnf groupinfo --hidden "Security Tools")

3. Какая команда позволяет вам установить rpm, который вы загрузили из Интернета и который не находится в репозиториях?

- sudo rpm -Uvh /path/to/package.rpm (или sudo dnf install /path/to/package.rpm)

4. Вы хотите убедиться, что пакет rpm, который вы загрузили, не содержит никакого опасного кода сценария. Какая команда позволяет это сделать?

- rpm --checksig --nosignature /path/to/package.rpm (или rpm --checksig /path/to/package.rpm)

5. Какая команда показывает всю документацию в rpm?

- rpm -q --docs -p /path/to/package.rpm (или rpm -qd package-name)

6. Какая команда показывает, какому пакету rpm принадлежит файл?

- rpm -qf /path/to/file

# Выводы

Я получил навыки работы с репозиториями и менеджерами пакетов в Rocky.

# Список литературы{.unnumbered}

::: {#refs}
:::
